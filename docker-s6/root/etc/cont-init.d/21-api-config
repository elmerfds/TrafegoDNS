#!/command/with-contenv bash

# API and debug configuration
echo "----------------------------------------"
echo "Configuring API settings..."
echo "----------------------------------------"

# Set defaults for API mode
USE_API_MODE=${USE_API_MODE:-true}
API_PORT=${API_PORT:-3000}
API_ONLY=${API_ONLY:-false}
LOCAL_AUTH_BYPASS=${LOCAL_AUTH_BYPASS:-true}
ENABLE_SWAGGER=${ENABLE_SWAGGER:-false}
DEBUG_MODE=${DEBUG_MODE:-false}

# Print current settings
echo "API mode: ${USE_API_MODE}"
echo "API port: ${API_PORT}"
echo "API only: ${API_ONLY}"
echo "Local auth bypass: ${LOCAL_AUTH_BYPASS}"
echo "Swagger enabled: ${ENABLE_SWAGGER}"
echo "Debug mode: ${DEBUG_MODE}"

# Export to the environment to make them available to all services
export USE_API_MODE
export API_PORT
export API_ONLY
export LOCAL_AUTH_BYPASS
export ENABLE_SWAGGER
export DEBUG_MODE

# Set development mode if debug mode is enabled
if [ "$DEBUG_MODE" = "true" ]; then
  echo "Debug mode enabled, setting NODE_ENV=development"
  export NODE_ENV=development
fi

echo "API configuration complete."