#!/command/with-contenv bash

echo
echo "-------------------------------------"
echo "Starting Tr√°fegoDNS..."
echo "-------------------------------------"
echo
cd /app

# Default to API mode unless explicitly disabled
USE_API_MODE=${USE_API_MODE:-true}
API_PORT=${API_PORT:-3000}
LOCAL_AUTH_BYPASS=${LOCAL_AUTH_BYPASS:-true}

# Log startup mode
if [ "$USE_API_MODE" = "true" ]; then
  echo "Starting in API mode (port: $API_PORT)"
else
  echo "Starting in CLI-only mode (API disabled)"
fi

# Start the application with the abc user
exec s6-setuidgid abc node src/app.js